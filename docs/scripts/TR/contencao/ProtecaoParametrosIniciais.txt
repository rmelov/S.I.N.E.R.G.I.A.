CREATE TRIGGER tg_ProtecaoParametrosIniciais
ON PARAMETRO_HIERARQUIA
FOR UPDATE, DELETE
AS
BEGIN
    SET NOCOUNT ON;

    IF UPDATE(DESIGNACAO_PARAMETRO)
    BEGIN
        IF EXISTS(
            SELECT
                1
            FROM
                deleted 
            WHERE
                DESIGNACAO_PARAMETRO
            IN(
                'STATUS_DISCENTE_INICIAL', 
                'STATUS_PROJETO_INICIAL',                 
                'ORDEM_AUTORIA_PRINCIPAL',
                'ORDEM_AUTORIA_COAUTORIA',
                'ORDEM_AUTORIA_APOIO_TECNICO'
            )
        )
        BEGIN
            RAISERROR(
                'Não. A designação deste parâmetro é vital para o sistema e não pode ser alterada.',
                16,
                1
            );
            ROLLBACK TRANSACTION;
            RETURN;
        END
    END

    IF EXISTS(
        SELECT
            1
        FROM
            deleted 
        WHERE
            DESIGNACAO_PARAMETRO
        IN(
            'STATUS_DISCENTE_INICIAL', 
            'STATUS_PROJETO_INICIAL',                 
            'ORDEM_AUTORIA_PRINCIPAL',
            'ORDEM_AUTORIA_COAUTORIA',
            'ORDEM_AUTORIA_APOIO_TECNICO'
        )
    )
    BEGIN
        RAISERROR(
            'Não. Este parâmetro é vital para o sistema e não pode ser excluído.',
            16,
            1
        );
        ROLLBACK TRANSACTION;
        RETURN;
    END
END;