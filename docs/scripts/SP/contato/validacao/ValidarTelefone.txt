CREATE PROCEDURE sp_ValidarTelefone
    @TELEFONE VARCHAR(50)
AS
BEGIN
    SET NOCOUNT ON;

    IF @TELEFONE IS NULL OR LEN(TRIM(@TELEFONE)) = 0
        BEGIN
            RAISERROR(
                'Telefone não pode estar vazio.',
                16,
                1
            );
            RETURN 1;
        END

    IF LEN(TRIM(@TELEFONE)) > 20
        BEGIN RAISERROR(
            'Quantidade de caracteres excessiva em Telefone.',
            16,
            1
        );
            RETURN 1;
        END

    IF NOT (
        @TELEFONE LIKE '+%' 
        AND @TELEFONE NOT LIKE '+%[^0-9]%'
        AND(
            (
                @TELEFONE LIKE '+55%' AND LEN(@TELEFONE) BETWEEN 13 AND 14
            )
            OR(
                @TELEFONE NOT LIKE '+55%' AND LEN(@TELEFONE) BETWEEN 9 AND 17
            )
        )
    )
    BEGIN
        RAISERROR(
            'Telefone com formato inválido. Use: +[DDI][DDD][Número].',
            16,
            1
        );
        RETURN 1;
    END

    RETURN 0;

END;    